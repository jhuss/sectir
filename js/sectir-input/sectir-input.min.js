!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.TreeModel=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d;c=a("mergesort"),d=a("find-insert-index"),b.exports=function(){"use strict";function TreeModel(a){a=a||{},this.config=a,this.config.childrenPropertyName=a.childrenPropertyName||"children",this.config.modelComparatorFn=a.modelComparatorFn}function a(a,b){return b.parent=a,a.children.push(b),b}function b(a,b){this.config=a,this.model=b,this.children=[]}function e(){var a={};if(1===arguments.length?a.fn=arguments[0]:2===arguments.length?"function"==typeof arguments[0]?(a.fn=arguments[0],a.ctx=arguments[1]):(a.options=arguments[0],a.fn=arguments[1]):(a.options=arguments[0],a.fn=arguments[1],a.ctx=arguments[2]),a.options=a.options||{},a.options.strategy||(a.options.strategy="pre"),!f[a.options.strategy])throw new Error("Unknown tree walk strategy. Valid strategies are 'pre' [default], 'post' and 'breadth'.");return a}var f;return f={},TreeModel.prototype.parse=function(d){var e,f,g;if(!(d instanceof Object))throw new TypeError("Model must be of type object.");if(g=new b(this.config,d),d[this.config.childrenPropertyName]instanceof Array)for(this.config.modelComparatorFn&&(d[this.config.childrenPropertyName]=c(this.config.modelComparatorFn,d[this.config.childrenPropertyName])),e=0,f=d[this.config.childrenPropertyName].length;f>e;e++)a(g,this.parse(d[this.config.childrenPropertyName][e]));return g},b.prototype.isRoot=function(){return void 0===this.parent},b.prototype.isLeaf=function(){return 0==this.children.length},b.prototype.hasChildren=function(){return this.children.length>0},b.prototype.addChild=function(a){var c;if(!(a instanceof b))throw new TypeError("Child must be of type Node.");return a.parent=this,this.model[this.config.childrenPropertyName]instanceof Array||(this.model[this.config.childrenPropertyName]=[]),this.config.modelComparatorFn?(c=d(this.config.modelComparatorFn,this.model[this.config.childrenPropertyName],a.model),this.model[this.config.childrenPropertyName].splice(c,0,a.model),this.children.splice(c,0,a)):(this.model[this.config.childrenPropertyName].push(a.model),this.children.push(a)),a},b.prototype.getPath=function(){var a=[];return function b(c){a.unshift(c),c.isRoot()||b(c.parent)}(this),a},b.prototype.walk=function(){var a;a=e.apply(this,arguments),f[a.options.strategy].call(this,a.fn,a.ctx)},f.pre=function g(a,b){var c,d,e;for(e=a.call(b,this),c=0,d=this.children.length;d>c;c++){if(e===!1)return!1;e=g.call(this.children[c],a,b)}return e},f.post=function h(a,b){var c,d,e;for(c=0,d=this.children.length;d>c;c++)if(e=h.call(this.children[c],a,b),e===!1)return!1;return e=a.call(b,this)},f.breadth=function(a,b){var c=[this];!function d(){var e,f,g;if(0!==c.length){for(g=c.shift(),e=0,f=g.children.length;f>e;e++)c.push(g.children[e]);a.call(b,g)!==!1&&d()}}()},b.prototype.all=function(){var a,b=[];return a=e.apply(this,arguments),f[a.options.strategy].call(this,function(c){a.fn.call(a.ctx,c)&&b.push(c)},a.ctx),b},b.prototype.first=function(){var a,b;return a=e.apply(this,arguments),f[a.options.strategy].call(this,function(c){return a.fn.call(a.ctx,c)?(b=c,!1):void 0},a.ctx),b},b.prototype.leaves=function(){return this.all(function(a){return a.isLeaf()})},b.prototype.drop=function(){var a;return this.isRoot()||(a=this.parent.children.indexOf(this),this.parent.children.splice(a,1),this.parent.model[this.config.childrenPropertyName].splice(a,1),this.parent=void 0,delete this.parent),this},TreeModel}()},{"find-insert-index":2,mergesort:3}],2:[function(a,b){b.exports=function(){"use strict";function a(a,b,c){var d,e;for(d=0,e=b.length;e>d&&!(a(b[d],c)>0);d++);return d}return a}()},{}],3:[function(a,b){b.exports=function(){"use strict";function a(c,d){var e,f,g=d.length;return g>=2?(e=d.slice(0,g/2),f=d.slice(g/2,g),b(c,a(c,e),a(c,f))):d.slice()}function b(a,b,c){for(var d=[],e=b.length,f=c.length;e>0&&f>0;)a(b[0],c[0])<=0?(d.push(b.shift()),e--):(d.push(c.shift()),f--);return e>0?d.push.apply(d,b):d.push.apply(d,c),d}return a}()},{}]},{},[1])(1)}),function(){angular.module("sectirTableModule.groupinput",["sectirTableModule.dataFactory"]).directive("sectirGroupInput",["sectirDataFactory","$compile",function(a,b){var c;return c={namespace:"default",debugmodel:!1,typefield:"type",namefield:"name",optionsfield:"options"},{restrict:"EA",scope:{namespace:"=?",tabledata:"=",namefield:"=?",typefield:"=?",debugmodel:"=?",optionsfield:"=?",scopedata:"="},link:function(d,e){var f;return d.answersObject={},f=function(){var a,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(k in c)n=c[k],angular.isDefined(d[k])||(d[k]=n);for(o=angular.element("<table>"),o.addClass("sectir-groupinput-main"),r=d.scopedata,p=0,q=r.length;q>p;p++){if(m=r[p],f="answersObject['"+m.id+"']",j=angular.element("<tr>"),j.addClass("sectir-groupinput-wrapper"),i=angular.element("<td>"),i.addClass("sectir-groupinput-namefield"),i.text(m[d.namefield]),l="select"===m[d.typefield]?"select":"input",g=angular.element("<"+l+">"),"input"===l&&g.attr("type",m[d.typefield]),g.attr("ng-model",f),angular.isDefined(m[d.optionsfield])){s=m[d.optionsfield];for(k in s)n=s[k],g.attr(k,n)}j.append(i),a=angular.element("<td>"),a.addClass("sectir-groupinput-cell"),a.append(g),j.append(a),d.debugmodel&&(h=angular.element("<td>"),h.text("{{"+f+"}}"),j.append(h)),o.append(j)}b(o)(d),e.append(o)},f(),d.$watch("answersObject",function(){return console.log("Guardando datos"),a.saveData(d.answersObject,d.namespace)},!0)}}}])}.call(this),function(){angular.module("sectirTableModule.input",["sectirTableModule.dataFactory"]).directive("sectirInput",["sectirDataFactory","$compile",function(a,b){var c;return c={namespace:"default",debugmodel:!1,typefield:"type",namefield:"name",optionsfield:"options"},{restrict:"EA",scope:{namespace:"=?",typefield:"=?",debugmodel:"=?",namefield:"=?",optionsfield:"=?",scopedata:"="},link:function(d,e){var f,g;return f=function(){var a,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(k in c)n=c[k],angular.isDefined(d[k])||(d[k]=n);for(o=angular.element("<div>"),o.addClass("sectir-input-main"),r=d.scopedata,p=0,q=r.length;q>p;p++){if(m=r[p],a="answersObject['"+m.id+"']",j=angular.element("<div>"),j.addClass("sectir-input-wrapper"),i=angular.element("<div>"),i.addClass("sectir-input-namefield"),i.text(m[d.namefield]),l="select"===m[d.typefield]?"select":"input",f=angular.element("<div>"),f.addClass("sectir-input-input"),g=angular.element("<"+l+">"),"input"===l&&g.attr("type",m[d.typefield]),g.attr("ng-model",a),f.append(g),angular.isDefined(m[d.optionsfield])){s=m[d.optionsfield];for(k in s)n=s[k],g.attr(k,n)}j.append(i),j.append(f),d.debugmodel&&(h=angular.element("<div>"),h.text("{{"+a+"}}"),j.append(h)),o.append(j)}return d.answersObject={},b(o)(d),e.append(o)},g=function(){return[d.namespace,d.scopedata]},f(),d.$watch("answersObject",function(){return console.log("Guardando datos"),a.saveData(d.answersObject,d.namespace)},!0)}}}])}.call(this),function(){angular.module("sectirTableModule.pager",["sectirTableModule.dataFactory","sectirTableModule.input","sectirTableModule.table","sectirTableModule.groupinput"]).directive("sectirPager",["$compile",function(a){return{restrict:"EA",scope:{values:"=",settings:"=?",finalizefunc:"&"},controller:["$scope",function(a){return a.currPos=0,a.nextButtonClick=function(){a.isNextButtonClickable()&&a.currPos++},a.prevButtonClick=function(){a.isPrevButtonClickable()&&--a.currPos},a.isPrevButtonClickable=function(){return a.currPos>0},a.isNextButtonClickable=function(){return a.currPos<a.values.length-1},a.isFinalizeButtonClickable=function(){return a.finalizefunc&&a.currPos===a.values.length-1},a.nextButtonText="Siguiente",a.prevButtonText="Anterior",a.finalizeButtonText="Finalizar"}],link:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(n=angular.copy(b.values),j=angular.element("<div>"),j.addClass("sectir-pager-wholecontainer"),l={},l.all=angular.isDefined(b.settings),v=["input","table","groupinput"],r=0,t=v.length;t>r;r++)o=v[r],l[o]=l.all&&angular.isDefined(b.settings[o]);for(k=s=0,u=n.length;u>s;k=++s){switch(p=n[k],i=angular.element("<div>"),i.addClass("sectir-pager-container"),p.type){case"input":h=angular.element("<sectir-input>");break;case"table":h=angular.element("<sectir-table>");break;case"groupinput":h=angular.element("<sectir-group-input>");break;default:throw new Error("Type must be input, table\nor group-input")}if(l[p.type])for(m in b.settings[p.type])h.attr(m,"settings."+p.type+"."+m);q=function(){switch(p.type){case"input":case"groupinput":return"scopedata";case"table":return"tabledata";default:return""}}(),h.attr(q,"values["+k+"].values"),h.attr("namespace","values["+k+"].namespace"),i.attr("ng-show","currPos === "+k),i.append(h),j.append(i)}return d=angular.element("<div>"),d.addClass("sectir-pager-button-row"),g=angular.element("<button>"),g.addClass("sectir-pager-prev-button"),g.text("{{ prevButtonText }}"),g.attr("ng-click","prevButtonClick()"),g.attr("ng-disabled","!isPrevButtonClickable()"),f=angular.element("<button>"),f.addClass("sectir-pager-next-button"),f.text("{{ nextButtonText }}"),f.attr("ng-click","nextButtonClick()"),f.attr("ng-disabled","!isNextButtonClickable()"),e=angular.element("<button>"),e.addClass("sectir-pager-final-button"),e.text("{{ finalizeButtonText }}"),e.attr("ng-click","finalizefunc()"),e.attr("ng-disabled","!isFinalizeButtonClickable()"),d.append(g),d.append(f),d.append(e),j.append(d),a(j)(b),c.append(j)}}}])}.call(this),function(){angular.module("sectirTableModule.table",["sectirTableModule.treeFactory","sectirTableModule.dataFactory"]).directive("sectirTable",["sectirTreeFactory","sectirDataFactory","$compile",function(a,b,c){var d;return d={namespace:"default",deletefieldlabel:"Delete",debugmodel:!1,deletelabel:"Delete",typefield:"type",titlefield:"name",optionsfield:"options",addlabel:"Add",addfieldlabel:"Add",subquestions:!1,subqenun:"enunciado",anocomienzo:!1,anofinal:!1},{restrict:"EA",scope:{namespace:"=?",tabledata:"=",titlefield:"=?",deletelabel:"=?",deletefieldlabel:"=?",addfieldlabel:"=?",addlabel:"=?",typefield:"=?",debugmodel:"=?",optionsfield:"=?",subquestions:"=?",subqenun:"=?",anocomienzo:"=?",anofinal:"=?"},controller:["$scope",function(a){return a.answersObject={},a.subquestions||(a.answersObject.values=[]),a.addAnswer=function(){return a.answersObject.values.push({})},a.deleteAnswer=function(b){return a.answersObject.values.splice(b,1),a.answersObject.values.length<1?a.addAnswer():void 0},a.haveSubQuestions=function(){return a.subquestions instanceof Array},a.subqtitle="Opciones"}],link:function(e,f){var g,h;return g=function(){var b,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;for(l in d)B=d[l],angular.isDefined(e[l])||(e[l]=B);for(j=e.haveSubQuestions(),a.addTree(e.tabledata,e.namespace,e.titlefield,e.typefield,e.anocomienzo,e.anofinal),p=a.getRows(e.namespace),n=f.find("table"),angular.isElement(n)&&n.remove(),u=angular.element("<table>"),u.addClass("sectir-table"),i=!0,y=[],C=0,G=p.length;G>C;C++){for(o=p[C],k=[],x=angular.element("<tr>"),x.addClass("sectir-table-header"),D=0,H=o.length;H>D;D++)h=o[D],b=angular.element("<th>"),b.text(h.model[e.titlefield]),b.addClass("sectir-header"),b.attr("colspan",a.getNumberLeafsFromNode(h.model.id,e.namespace)),q=function(){var b;return b=a.hasChildrenById(h.model.id,e.namespace),b?1:a.getNodeLevelsFromMax(h.model.id,e.namespace)+1}(),b.attr("rowspan",q),k.push(b);for(i&&(i=!1,z=a.getTreeHeight(e.namespace),j?(b=angular.element("<th>"),b.addClass("sectir-subq-title"),b.text("{{subqtitle}}"),b.attr("colspan",1),b.attr("rowspan",z),k.unshift(b)):(b=angular.element("<th>"),b.addClass("sectir-delete"),s=angular.element("<span>"),s.text("{{ deletelabel }}"),b.append(s),b.attr("colspan",1),b.attr("rowspan",z),g=angular.element("<th>"),g.addClass("sectir-add"),r=angular.element("<span>"),r.text("{{ addlabel }}"),g.append(r),g.attr("colspan",1),g.attr("rowspan",z),k.push(g),k.push(b))),E=0,I=k.length;I>E;E++)A=k[E],x.append(A);y.push(x)}for(F=0,J=y.length;J>F;F++)A=y[F],u.append(A);if(m=function(a,b){var c;return null==b&&(b=!1),c="answersObject.values",b===!1&&(c+="[$index]"),c+="['"+a+"']",b!==!1&&(c+="['"+b+"']"),c},w=function(b){var c,d,f,g,h,i,k,n;return null==b&&(b=!1),g=a.getLeafs(e.namespace),i=angular.element("<tr>"),b===!1&&i.attr("ng-repeat","ans in answersObject.values"),i.addClass("sectir-ans-row"),h=a.getLeafs(e.namespace,"pre"),f=function(){var a,c,d,f,g,k,n,o,p,q;for(b&&(c=angular.element("<th>"),c.text(b[e.subqenun]),c.addClass("sectir-table-subq"),i.append(c)),q=0,p=h.length;p>q;q++){if(g=h[q],a=angular.element("<th>"),a.addClass("sectir-answer"),n=j?m(g.model.id,b.id):m(g.model.id),o=angular.isDefined(g.model[e.typefield]),f=angular.element(o&&"select"===g.model[e.typefield]?"<select>":"<input>"),f.attr("ng-model",n),o&&f.attr("type",g.model[e.typefield]),angular.isDefined){g.model[e.optionsfield],k=g.model[e.optionsfield];for(l in k)B=k[l],f.attr(l,B)}e.debugmodel&&(d=angular.element("<i>"),d.addClass("sectir-debug-model"),d.text("{{ "+n+" }}")),a.append(f),e.debugmodel&&a.append(d),i.append(a)}},f(),j||(d=angular.element("<th>"),d.addClass("sectir-button-delete"),n=angular.element("<span>"),n.attr("ng-click","deleteAnswer($index)"),n.text("{{ deletefieldlabel }}"),d.append(n),c=angular.element("<th>"),c.addClass("sectir-button-add"),k=angular.element("<span>"),k.attr("ng-click","addAnswer()"),k.text("{{ addfieldlabel }}"),c.append(k),i.append(c),i.append(d)),i},j)for(M=e.subquestions,L=0,K=M.length;K>L;L++)t=M[L],v=w(t),u.append(v);else v=w(),u.append(v);return c(u)(e),f.append(u),j?void 0:e.addAnswer()},h=function(){return[e.namespace,e.tabledata]},g(),e.$watch("answersObject",function(){return console.log("Guardando datos"),b.saveData(e.answersObject,e.namespace)},!0)}}}])}.call(this),function(){angular.module("sectirTableModule.dataFactory",[]).factory("sectirDataFactory",function(){var a;return new(a=function(){function a(){this.data={}}return a.prototype.saveData=function(a,b){return null==b&&(b="default"),this.data[b]=a},a.prototype.getData=function(a){return null==a&&(a="default"),this.data[a]},a}())})}.call(this),function(){var a;a=angular.module("sectirTableModule.treeFactory",["sectirTableModule.treeModelFactory"]),a.factory("sectirTreeFactory",["treeModelFactory",function(a){var b;return new(b=function(){function b(){this.trees={},this.maxHeights={},this.nodesById={}}return b.prototype.reset=function(){return this.trees={},this.maxHeights={},this.nodesById={}},b.prototype.addTree=function(b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;if(null==c&&(c="default"),null==d&&(d="name"),null==e&&(e="type"),null==f&&(f=!1),null==g&&(g=!1),m=a.parse(b),f||g)for(l=m.all(function(a){return"ano"===a.model[e]}),n=0,p=l.length;p>n;n++)for(j=l[n],h=o=f;g>=o;h=o+=1)i={},i.id=""+j.model.id+"-"+h,i[e]="number",i[d]=""+h,k=a.parse(i),j.addChild(k);this.trees[c]=m,this.maxHeights[c]=void 0,this.nodesById[c]={}},b.prototype.getTreeHeight=function(a){var b;return null==a&&(a="default"),null!=this.maxHeights[a]?this.maxHeights[a]:(b=0,this.trees[a].walk(function(a){var c;c=a.getPath().length,c>b&&(b=c)}),this.maxHeights[a]=b)},b.prototype.getNodeHeightById=function(a,b){var c;return null==b&&(b="default"),c=this.getNodeById(a,b),c?c.getPath().length:!1},b.prototype.getNodeById=function(a,b){var c,d;return null==b&&(b="default"),null==this.trees[b]?!1:null!=this.nodesById[b][a]?this.nodesById[b][a]:(a=String(a),c=!1,null!=(d=this.trees[b])&&d.walk(function(b){var d;return d=String(b.model.id),d===a?(c=b,!1):void 0}),this.nodesById[b][a]=c)},b.prototype.hasChildren=function(a){return null!=a.children&&a.children.length>0},b.prototype.hasChildrenById=function(a,b){return null==b&&(b="default"),this.hasChildren(this.getNodeById(a,b))},b.prototype.getLeafs=function(a,b){var c,d,e;return null==a&&(a="default"),null==b&&(b="breadth"),e={strategy:b},d=this,c=null!=this.trees[a]?this.trees[a].all(e,function(a){return!d.hasChildren(a)}):!1},b.prototype.getRows=function(a){var b,c,d,e;return null==a&&(a="default"),e={strategy:"breadth"},c=[],b=-1,d=this,this.trees[a].walk(e,function(e){var f;f=d.getNodeHeightById(e.model.id,a),f!==b&&(c.push([]),b=f),c[b-1].push(e)}),c},b.prototype.getNodeLevelsFromMax=function(a,b){var c;return null==b&&(b="default"),c=this.getNodeById(a,b),c===!1?!1:this.getTreeHeight(b)-c.getPath().length},b.prototype.getNumberLeafsFromNode=function(a,b){var c,d,e;return null==b&&(b="default"),c=this.getNodeById(a,b),c===!1?!1:(d=0,e=this,c.walk(function(a){e.hasChildren(a)||d++}),d)},b}())}])}.call(this),function(){angular.module("sectirTableModule.treeModelFactory",[]).factory("treeModelFactory",function(){return new TreeModel})}.call(this),function(){angular.module("sectirTableModule",["sectirTableModule.table","sectirTableModule.input","sectirTableModule.groupinput","sectirTableModule.pager","sectirTableModule.treeModelFactory"])}.call(this),function(){var a;a=angular.module("sectirRespuestaApp",["sectirTableModule"]),a.provider("sectirRespuestaConfig",function(){return this.url=!1,{set:function(a){return this.url=a},$get:function(){return{getURL:function(){return this.url}}}}}),a.controller("sectirRespuestaCtrl",["$http","$scope","sectirRespuestaConfig",function(a,b,c){var d;b.jsonData=!1,d=function(a){return b.jsonData=a},a.get(c.getUrl()).then(d)}]),window.sectirRApp=a}.call(this);